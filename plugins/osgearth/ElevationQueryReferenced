// kate: syntax C++11;
// SGI - Copyright (C) 2012-2015 FAST Protect, Andreas Roth

#pragma once

namespace osgEarth {
    class ElevationQuery;
    class TileSource;
    class TileKey;
    class CacheBin;
    class TerrainLayer;
}

namespace sgi {
namespace osgearth_plugin {

    typedef ReferencedRawPtrT<osgEarth::ElevationQuery> ElevationQueryReferenced;
    typedef ReferencedDataT<osgEarth::TileKey> TileKeyReferenced;

    struct TileSourceTileKeyData
    {
        enum Status {
            StatusNotLoaded = 0,
            StatusLoaded,
            StatusLoadFailure,
            StatusNoData
        };
        enum ObjectType {
            ObjectTypeGeneric = 0,
            ObjectTypeImage,
            ObjectTypeHeightField,
            ObjectTypeNode,
            ObjectTypeString
        };

        static ObjectType getObjectType(osgEarth::CacheBin * cb);
        static ObjectType getObjectType(osgEarth::TileSource * ts);
        static ObjectType getObjectType(osgEarth::TerrainLayer * tl);

        TileSourceTileKeyData(osgEarth::TileSource * ts, const osgEarth::TileKey & tk, osg::Referenced * td = NULL);
        TileSourceTileKeyData(osgEarth::TerrainLayer * tl, const osgEarth::TileKey & tk, osg::Referenced * td = NULL);
        TileSourceTileKeyData(osgEarth::CacheBin * cb, ObjectType type, const osgEarth::TileKey & tk, osg::Referenced * td = NULL);

        osg::ref_ptr<osgEarth::TileSource> tileSource;
        osg::ref_ptr<osgEarth::TerrainLayer> terrainLayer;
        osg::ref_ptr<osgEarth::CacheBin> cacheBin;
        osgEarth::TileKey tileKey;
        osg::ref_ptr<osg::Referenced> tileData;
        Status status;
        ObjectType objectType;
    };
    typedef ReferencedDataT<TileSourceTileKeyData> TileSourceTileKey;

} // namespace osgearth_plugin
} // namespace sgi
